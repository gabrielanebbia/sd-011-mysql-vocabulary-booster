DELIMITER $$
CREATE FUNCTION buscar_quantidade_de_empregos_por_funcionario(EMAIL VARCHAR(200))
RETURNS INT READS SQL DATA
BEGIN
DECLARE NUMBER_JOBS INT;
SELECT COUNT(*)
FROM hr.job_history AS H
INNER JOIN hr.employees AS E
ON H.EMPLOYEE_ID = E.EMPLOYEE_ID
WHERE E.EMAIL = EMAIL
GROUP BY H.EMPLOYEE_ID
INTO NUMBER_JOBS;
RETURN NUMBER_JOBS;
END $$
DELIMITER ;