SELECT 
JOB_TITLE AS 'Cargo',
ROUND(AVG (MAX_SALARY - MIN_SALARY), 2) AS 'Média salarial',
CASE 
WHEN (ROUND(AVG (MAX_SALARY - MIN_SALARY), 2) >= 2000) AND (ROUND(AVG (MAX_SALARY - MIN_SALARY) <= 5800)) THEN 'Júnior'
WHEN (ROUND(AVG (MAX_SALARY - MIN_SALARY), 2) >= 5801) AND (ROUND(AVG (MAX_SALARY - MIN_SALARY) <= 7500)) THEN 'Pleno'
WHEN (ROUND(AVG (MAX_SALARY - MIN_SALARY), 2) >= 7501) AND (ROUND(AVG (MAX_SALARY - MIN_SALARY) <= 10500)) THEN 'Sênior'
WHEN (ROUND(AVG (MAX_SALARY - MIN_SALARY), 2)) > 10500 THEN 'CEO'
END AS 'Senioridade'
FROM hr.jobs
GROUP BY JOB_TITLE
ORDER BY ROUND(AVG (MAX_SALARY - MIN_SALARY), 2) ASC, JOB_TITLE ASC;
